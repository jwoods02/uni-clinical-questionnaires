<!DOCTYPE html>
<html lang="en">
<!-- Latest compiled and minified CSS -->
<head>
    <meta charset="UTF-8">
    <title>Create New Question</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://rubaxa.github.io/Sortable/Sortable.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
    <!--<link rel="stylesheet" href="/css/interface-style.css">-->

</head>

<body>

<style>
    
    .hide {
        display: none;
    }
    .card {
        margin-bottom: 15px;
    }
    #sortable2 {
        min-height: 50vh;
    }
    li {
        text-decoration: none;
    }

    .question-list-item {
        padding: 0;
        width: auto;
        margin-bottom: 1rem;
    }
    .question-list-item .input-group-addon {
        border: none;
    }
    .question-list-text {
        margin-top: 0.5rem;
        margin-bottom: 0.5rem;
    }

</style>

<div id="navbar-template"></div>

<div class="jumbotron">
    <div class="container">
        <form class="form" method="post" action="/api/question">
            <fieldset>
                <!-- Create Question Form -->
                <h1>Create / Edit Questionnaire</h1>

                <!-- Question-->
                <div class="form-group">
                    <label class="control-label" for="description">Questionnaire Title</label>
                    <input id="description" name="description" type="text" placeholder="Questionnaire Title" class="form-control input-md">
                    <span class="help-block">Write the questionnaire title here</span>
                </div>

                <!-- Submit button -->
                <div class="form-group">
                    <button id="submit" name="submit" class="btn btn-primary">Submit</button>
                </div>

            </fieldset>
        </form>
    </div>
</div>
<div class="container">
    <div class="row">
        <ul id="sortable" class="col-md-3 text-center connected-sortable">
            <li class="card ui-state-default multiple-choice">
                    <p class="card-header">Multiple Choice</p>
            </li>
            <li class="card ui-state-default radio-button">
                <div class="card-block">
                    <p class="card-header">Radio Button</p>
                </div>
            </li>
            <li class="card ui-state-default single-line">
                <div class="card-block">
                    <p class="card-header">Single Line Answer</p>
                </div>
            </li>
            <li class="card ui-state-default multi-line">
                <div class="card-block">
                    <p class="card-header">Multiple Line Answer</p>
                </div>
            </li>
        </ul>
        <div class="col-md-9">
            <ul id="sortable2" class="list-group sortable2 connected-sortable">


            </ul>

        </div>
    </div>

</div>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="create_question">

                </div>
            </div>
        </div>
    </div>
</div>
<script src="../js/templates.js"></script>


<!-- ------------QUESTION LIST ITEM TEMPLATE ---------------- -->
<li class="list-group-item question-list-item list-group-item-action flex-column align-items-start question-list-item-template hide" id="45">

    <div class="d-flex w-100 justify-content-between">
        <span class="input-group-addon"><i class="fa fa-bars" aria-hidden="true"></i></span>

        <p class="question-list-text">Question Title</p>

        <div class="btn-group input-group-btn">
            <button class="btn btn-primary" data-toggle="modal" data-target="#exampleModal" type="button">
                <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
            </button>
            <button class="btn btn-danger delete-option" type="button">
                <i class="fa fa-times" aria-hidden="true"></i>
            </button>
        </div>
    </div>

</li>


<script>
    $( ".create_question" ).load( "create_question" );
    $( ".create_question2" ).load( "create_question" );

</script>

<script>
    $(document.body).on('click', '.delete-option', function () {
        $(this).closest('li').remove();
    });
</script>


<!--Drag and Drop Interface-->
<script>

    var template = $(".question-list-item-template").clone();

    $(template).removeClass('hide');

    var sort1 = document.getElementById('sortable');
    var sort2 = document.getElementById('sortable2')
    var sortable1 = Sortable.create(sort1, {
        group: {
            name: 'sort1',
            pull: 'clone',
            put: false,
        },
        sort: false,
        onEnd: function(evt) {

            if ( $( evt.item ).hasClass( "multiple-choice" ) ) {

                $(evt.item).replaceWith( template.clone() );

            } else if ( $( evt.item ).hasClass( "radio-button" ) ) {

                $(evt.item).replaceWith( template.clone() );

            } else if ( $( evt.item ).hasClass( "single-line" ) ) {

                $(evt.item).replaceWith( template.clone() );

            } else if ( $( evt.item ).hasClass( "multi-line" ) ) {

                $(evt.item).replaceWith( template.clone() );

            }

        },
    });
    var sortable2 = Sortable.create(sort2, {
        group: {
            name: 'sort2',
            pull: false,
            put: 'sort1',
        },
        animation: 125,
    });

    function newOption(type) {
        switch(type) {
            case 0:
                return '<p class="card-body"> New multiple choice question </p>' +
                    '<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal"> Edit</button> ' +
                    '<button class="btn btn-danger delete-option">Delete</button>'
                break;

            case 1:
                return '<p class="card-body"> New radio button question </p>' +
                    '<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal"> Edit</button> ' +
                    '<button class="btn btn-danger delete-option">Delete</button>'
                break;

            case 2:
                return '<p class="card-body"> New single line question </p>' +
                    '<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal"> Edit</button> ' +
                    '<button class="btn btn-danger delete-option">Delete</button>'
                break;

            case 3:
                return '<p class="card-body"> New multi line question </p>' +
                    '<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal"> Edit</button> ' +
                    '<button class="btn btn-danger delete-option">Delete</button>'
                break;

            default:
                return '<p class="card-title"> New unknown question </p>'
        }
    }


</script>
</body>
</html>